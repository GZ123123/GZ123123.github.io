document.addEventListener("DOMContentLoaded",function(){let e="Matakunkun";const t=document.querySelector(".modal-container"),o=function(t){e=t,document.querySelector("body").classList.value="",document.querySelector("#name-modal").remove(),document.querySelector(".banner svg").classList.add("active")};fetch("../song/santa-tell-me/lyric.lrc").then(e=>e.text()).then(e=>this.lr=new Lyricer(document.querySelector("audio"),e)),window.addEventListener("click",e=>{e.target==t&&(document.querySelector("body").classList.remove("modal-showed"),t.classList.remove("show"),function(){const e=document.querySelector("#modal-container");e.querySelector(".modal").classList.value="modal",e.querySelector(".container").innerHTML=""}())}),window.addEventListener("scroll",e=>{const t=document.querySelector("[data-toggle='scroll']");(e=>{const t=e.getBoundingClientRect();return t.top>=-e.offsetHeight/2&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)+e.offsetHeight/2})(t)&&!t.querySelector("svg").classList.contains("active")&&t.querySelector("svg").classList.add("active")}),document.querySelectorAll("[data-toggle='modal']").forEach(o=>o.addEventListener("click",o=>{const r=o.target.dataset.toggle?o.target:o.target.closest("[data-toggle='modal']"),{target:n}=r.dataset;!function(t){const o=document.querySelector(t),r=document.querySelector("#modal-container"),{class:n,ltr:a}=o.dataset,c=o.content.cloneNode("true").querySelector("fragment").innerHTML;n.split(" ").forEach(e=>r.querySelector(".modal").classList.add(e)),r.querySelector(".container").innerHTML=c.replace("%name%",e.trim()||"Matakunkun")}(`#${n}`),document.querySelector("body").classList.add("modal-showed"),t.classList.add("show")})),document.querySelector("audio").addEventListener("song-duration",e=>{document.querySelector(".duration").style=`--duration: ${e.detail.percent}%`}),document.querySelector("audio").addEventListener("lyric-update",e=>lyricer.innerHTML=e.detail.lyric),document.querySelector(".duration").addEventListener("click",e=>{const t=e.target.getBoundingClientRect();var o=e.clientX-t.left;this.lr.move(o/t.width)}),document.querySelectorAll(".icon").forEach(e=>e.addEventListener("click",e=>{e.target.classList.contains("play")?(e.target.classList.toggle("play"),e.target.classList.toggle("pause"),this.lr.play()):e.target.classList.contains("pause")&&(e.target.classList.toggle("play"),e.target.classList.toggle("pause"),this.lr.pause())})),document.querySelector("input[name='name']").addEventListener("keydown",e=>{13==e.keyCode&&e.target.value.trim()&&o(e.target.value)}),document.querySelector(".form-group .append").addEventListener("click",e=>{const t=e.target.closest(".form-group").querySelector(".form-control").value.trim();t.trim()&&o(t)})});